# 数论习题

## 约数和倍数

- 逐月 P1324
- 洛谷 P1403 约数研究
- 洛谷 P1414 又是毕业季
- 洛谷 P1372 又是毕业季
- 洛谷 P2926

约数枚举和倍数枚举经常相互转化。

### 洛谷 P1403 约数研究

使用约数法枚举求解，时间复杂度 $O(N \sqrt N)$。

不再枚举约数，而是枚举约数出现在多少个倍数中（倍数枚举）

使用倍数法枚举 $i$，求解 $1 \sim N$ 有多少数是 $i$ 的倍数（所有 $i$ 的倍数都会有约数 $i$），即 $\sum \limits_{i = 1} ^ N \lfloor \dfrac{N}{i} \rfloor$。时间复杂度 $O(N)$。

### 洛谷 P1372 又是毕业季 1

枚举约数 $d$（枚举答案），这 $k$ 个人 $d, 2d, 3d, \dots, kd$。只要最大的人的编号 $kd \le n$ 即可，即 $d \le \lfloor \dfrac{n}{k} \rfloor$。

### 洛谷 P1414 又是毕业季 2

枚举答案约数 $d$，看是否有至少 $k$ 个 $d$ 的倍数（如果有，答案是可以的）。

令 $V = 10^6$。

#### 算法 1

枚举 $k = i$

- 枚举答案 $d$
    - 枚举每个能力值，看有多少个 $d$ 的倍数

总时间 $O(n^2V)$。

#### 算法 2

使用倍数法预处理 $cnt_d$ 表示 $a_1 \dots a_n$ 中 $d$ 的倍数数量。$O(V \log V)$。

枚举 $k = i$

- 枚举答案 $d$，求 $cnt_d >= k$ 时 $d$ 的最大值。

时间复杂度 $O(V \log V + nV)$。

#### 算法 3

令 $ans_i$ 表示 $k = i$ 时的答案。

从小到大枚举答案 $d$

- 维护 $ans_{cnt_d}$ 的最大值。

注意到，并不是 $ans_1 \dots ans_n$ 都被求解出来

- $ans_n \ge 1$。
- 最终 $ans_i \ge ans_{i + 1}$。

- 从后往前维护 $ans_i = \max(ans_i, ans_{i + 1})$。

预处理 $O(V \log V)$，维护 $ans$ 数组 $O(V)$，总时间复杂度 $O(V \log V)$。$cnt$ 和 $ans$ 的空间复杂度 $O(V)$。

## 质数与合数

- 逐月 P1321 质数判断
- 逐月 P1322 埃氏筛
- 洛谷 P3383 欧拉筛
- 洛谷 P1835 区间筛

## gcd 和 lcm

- 逐月 P1325
- 洛谷 P1029 最大公约数和最小公倍数问题
- gcd on blackboard
- 洛谷 P1072
- 洛谷 P1572
- 洛谷 P4057
- 洛谷 P2651
- 洛谷 P2660
- CF 1154G

## 质因数分解

- 逐月 P1323，试除法分解质因数
- 逐月 P1324，欧拉筛预处理最小质因数，最小质因数分解法
- 洛谷 P2043，试除法、最小质因数法都写一遍。
- CF 546D，将 $1 \sim N$ 表示为质因数分解形式
- arc067_a，求 $N!$ 的质因数分解形式
- abc215_d，质因数分解 + 筛
- abc259_e，较难
- CF 1047C，较难

## 其他

- abc177_e